(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(e,t,a){},142:function(e,t){},145:function(e,t,a){},146:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(12),o=a.n(r),c=(a(101),a(18)),l=a(19),i=a(23),u=a(20),m=a(22),p=a(31),d=a(24),g=a(21),h="http://localhost:8080/api/",f=function(e){var t=e.split(".")[1].replace("-","+").replace("_","/");return JSON.parse(window.atob(t))},E=function(){return function(e){var t=localStorage.getItem("auth-token");if(!t)return e({type:"GET_CURRENT_USER",payload:null});var a=f(t).id;console.log(f(t)),fetch("".concat(h,"users/").concat(a)).then(function(e){return e.json()}).then(function(t){return e({payload:t.user,type:"GET_CURRENT_USER"})})}},v=a(151),b=a(41),y=a(25),N=a(148),k=a(49),w=a(149),O=a(13),S=a(152),j=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={disabled:!1,password:"",showPassword:!1,username:"",message:null,isOpen:!1},a.onLockClick=function(){return a.setState({showPassword:!a.state.showPassword})},a.onLogin=function(){a.props.login(a.state),a.setState({message:"",isOpen:!1})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.props.getCurrentUser()}},{key:"componentWillUpdate",value:function(e){var t=e.message;e.user||""!==t&&t!==this.state.message&&this.setState({message:t,isOpen:!0})}},{key:"render",value:function(){var e=this,t=this.state,a=t.showPassword,n=t.disabled,r=t.isOpen;if(this.props.user)return s.a.createElement(d.a,{to:"/"});var o=s.a.createElement(v.a,{content:"".concat(a?"Hide":"Show"," Password")},s.a.createElement(b.a,{icon:a?"unlock":"lock",intent:y.a.WARNING,minimal:!0,onClick:this.onLockClick}));return s.a.createElement(N.a,{className:"container mt-5",title:"Sign-up",icon:"new-person",intent:y.a.PRIMARY},s.a.createElement(k.b,null,"Usernname",s.a.createElement(w.a,{large:!0,min:5,max:20,placeholder:"Enter your username...",rightElement:s.a.createElement(O.a,{icon:"user",iconSize:20}),onChange:function(t){return e.setState({username:t.target.value})},intent:y.a.PRIMARY,fill:!0,round:!0,type:"text"})),s.a.createElement(k.b,null,"Password",s.a.createElement(w.a,{disabled:n,large:!0,min:8,placeholder:"Enter your password...",rightElement:o,onChange:function(t){return e.setState({password:t.target.value})},intent:y.a.PRIMARY,fill:!0,round:!0,type:a?"text":"password"})),s.a.createElement(S.a,{isOpen:r,canOutsideClickCancel:!0,confirmButtonText:"Ok",onConfirm:function(){return e.setState({isOpen:!1})},intent:y.a.DANGER},this.state.message),s.a.createElement(b.a,{icon:"log-in",intent:y.a.PRIMARY,minimal:!1,large:!0,onClick:this.onLogin}))}}]),t}(s.a.Component),U=Object(g.b)(function(e){var t=e.auth;return{user:t.user,message:t.message}},{login:function(e){var t=e.username,a=e.password;return function(e){var n={password:a,username:t};fetch("".concat(h,"users/login"),{body:JSON.stringify(n),headers:{"Content-Type":"application/json"},method:"POST"}).then(function(e){return e.json()}).then(function(t){if(t.token)return localStorage.setItem("auth-token",t.token),void e({payload:t.user,type:"LOGIN"});e({payload:t.info.message,type:"AUTH_ERR"})}).catch(function(t){return e({payload:t.message,type:"AUTH_ERR"})})}},getCurrentUser:E})(j),_=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={dateOfBirth:new Date,disabled:!1,password:"",showPassword:!1,username:"",message:null},a.onLockClick=function(){return a.setState({showPassword:!a.state.showPassword})},a.onSignup=function(){console.log(a.state),a.props.signup(a.state),a.setState({message:"",username:"",password:"",dateOfBirth:""})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.props.getCurrentUser()}},{key:"render",value:function(){var e=this,t=this.state,a=t.showPassword;t.disabled;if(this.props.user)return n.createElement(d.a,{to:"/"});var s=n.createElement(v.a,{content:"".concat(a?"Hide":"Show"," Password")},n.createElement(b.a,{icon:a?"unlock":"lock",intent:y.a.WARNING,minimal:!0,onClick:this.onLockClick})),r=n.createElement(v.a,{content:"Username"},n.createElement(b.a,{icon:"user",intent:y.a.WARNING,minimal:!0}));return n.createElement(N.a,{className:"container mt-5",title:"Sign-up",icon:"new-person",intent:y.a.PRIMARY},n.createElement(k.b,null,"Username",n.createElement(w.a,{large:!0,placeholder:"Enter your username...",rightElement:r,onChange:function(t){return e.setState({username:t.target.value})},intent:y.a.PRIMARY,fill:!0,round:!0,type:"text"})),n.createElement(k.b,null,"Password",n.createElement(w.a,{large:!0,placeholder:"Enter your password...",rightElement:s,onChange:function(t){return e.setState({password:t.target.value})},intent:y.a.PRIMARY,fill:!0,round:!0,type:a?"text":"password"})),n.createElement(k.b,null,"Date of birth",n.createElement(w.a,{onChange:function(t){return e.setState({dateOfBirth:t.target.value})},placeholder:"Date of birth",intent:y.a.PRIMARY,fill:!0,round:!0,large:!0,type:"date"})),n.createElement(b.a,{icon:"new-person",intent:y.a.PRIMARY,minimal:!1,large:!0,onClick:this.onSignup}))}}]),t}(n.Component),C=Object(g.b)(function(e){var t=e.auth,a=t.message,n=t.errors,s=t.user;return console.log(e),{message:a,errors:n,user:s}},{signup:function(e){var t=e.username,a=e.password,n=e.dateOfBirth;return function(e){var s={dateOfBirth:n,password:a,username:t};fetch("".concat(h,"users/signup"),{body:JSON.stringify(s),headers:{"Content-Type":"application/json"},method:"POST"}).then(function(e){return e.json()}).then(function(t){if(t.token)return e({payload:t.message,type:"SIGNUP"}),void localStorage.setItem("auth-token",t.token);console.log(t),e({payload:t.message,type:"AUTH_ERR"})}).catch(function(t){return e({payload:t.message,type:"AUTH_ERR"})})}},getCurrentUser:E})(_),R=a(86),I=a(35),M=a(87),P=a(88),A=a(150),T=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.props.getCurrentUser()}},{key:"componentWillReceiveProps",value:function(e){e.user}},{key:"renderLinks",value:function(){return this.props.user?s.a.createElement(R.a,{align:I.a.LEFT},s.a.createElement(M.a,null,"Meows Chat"),s.a.createElement(P.a,null),s.a.createElement(p.b,{to:"/",color:"#fff"},"Home"),s.a.createElement(P.a,null),s.a.createElement(p.b,{to:"/messages",color:"#fff"},"Messages")):s.a.createElement(R.a,{align:I.a.LEFT},s.a.createElement(M.a,null,"Meows Chat"),s.a.createElement(P.a,null),s.a.createElement(p.b,{to:"/signup/",color:"#fff"},"Signup"),s.a.createElement(P.a,null),s.a.createElement(p.b,{to:"/login/",color:"#fff"},"Login"))}},{key:"render",value:function(){return s.a.createElement(A.a,{style:{backgroundColor:"#2B95D6",color:"#fff"},className:"bp3-text-large"},this.renderLinks())}}]),t}(s.a.Component),G=Object(g.b)(function(e){return{user:e.auth.user}},{getCurrentUser:E})(T),x=a(48),W=a(89),L=a.n(W),B=a(90),H=a.n(B)()("localhost:8080",{port:"8080"}),Y=function(){return function(e){var t=localStorage.getItem("auth-token");if(!t)return e({type:"GET_MESSAGES",payload:[]});var a=new Headers;a.append("Authorization","Bearer ".concat(t)),fetch("".concat(h,"messages/"),{headers:a}).then(function(e){return e.json()}).then(function(t){console.log(t),e({payload:t.user,type:"GET_MESSAGES"})})}},D=(a(145),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={username:"",messages:[],users:[]},a.token=void 0,a.link=function(e,t){return s.a.createElement(p.b,{to:"/messages/".concat(t)},e)},a.message=function(e){var t="string"===typeof e.sender?e.receiver:e.sender;return s.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},s.a.createElement("div",{className:"d-flex bd-highlight",style:{cursor:"pointer"},onClick:a.openMessage.bind(Object(x.a)(a),t._id)},s.a.createElement("div",{className:"img_cont"},s.a.createElement("img",{src:t.profileImage,className:"rounded rounded-circle user_img"})),s.a.createElement("div",{className:"user_info"},s.a.createElement("span",{style:{color:"black"}},t.username))))},a.openMessage=function(e){return a.props.history.push("/message/"+e)},a.onSelect=function(e,t){a.openMessage(t._id)},a.onChange=function(e,t){if(a.setState({username:t}),t.length>=1){var n=a.props.users.filter(function(e){return e.username.includes(t)});a.setState({users:n})}},a.renderItem=function(e,t){return s.a.createElement("li",{className:"".concat(t?"active":""," list-group-item"),key:e._id},e.username)},a.token=localStorage.getItem("auth-token"),H.emit("getMessages",{token:a.token}),H.on("getMessages",function(e){a.setState({messages:e.messages})}),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.props.getCurrentUser(),this.props.getUserMessages(),this.props.getUsers()}},{key:"componentWillReceiveProps",value:function(e){this.setState({users:e.users})}},{key:"render",value:function(){var e=this,t=this.state,a=t.users,n=t.username,r=t.messages;return this.token?s.a.createElement("div",{className:"container h-150"},s.a.createElement("div",{className:"col-md-8 col-xl-8 ml-3 mr-3 chat"},s.a.createElement("div",{className:"card mb-sm-3 mb-md-0 contacts_card"},s.a.createElement("div",{className:"card-header"},s.a.createElement("div",{className:"input-group"},s.a.createElement(L.a,{inputProps:{className:"form-control search",placeholder:"Search..."},value:n,items:a.filter(function(e){return e.username.includes(n)}),getItemValue:function(e){return e.username},onSelect:this.onSelect,onChange:this.onChange,renderMenu:function(e){return s.a.createElement("ul",{className:"menu list-group"},e)},renderItem:this.renderItem}),s.a.createElement("div",{className:"input-group-prepend"},s.a.createElement("span",{className:"input-group-text search_btn"},s.a.createElement("i",{className:"fas fa-search"}))))),s.a.createElement("div",{className:"card-body contacts_body"},s.a.createElement("ul",{className:"contacts"},r.map(function(t){return e.message(t)})))))):s.a.createElement(d.a,{to:"/login"})}}]),t}(s.a.Component)),J=Object(g.b)(function(e){return{user:e.auth.user,messages:e.messages.messages,users:e.users.users}},{getCurrentUser:E,getUserMessages:Y,getUsers:function(){return function(e){fetch("".concat(h,"users/")).then(function(e){return e.json()}).then(function(t){e({payload:t.users,type:"GET_USERS"})})}}})(D),z=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).initUser={username:"",profileImage:""},a.state={messages:[],body:"",user:a.initUser,currentUser:a.initUser},a.token=localStorage.getItem("auth-token"),a.message=function(e){var t=e.sender,n=e.body,r=e.date,o=a.props.user;console.log(e,o);var c=new Date(r).toUTCString().split(" "),l="d-flex justify-content-".concat(t._id===o._id?"start":"end"," mb-4");return s.a.createElement("div",{className:l},s.a.createElement("div",{className:"img_cont_msg"},s.a.createElement("img",{src:e.sender.profileImage,className:"rounded-circle user_img_msg"})),s.a.createElement("div",{className:"msg_cotainer"},n,s.a.createElement("span",{className:"msg_time"},c[4],",",c[0])))},a.send=function(){var e=a.props.match.params.id,t=a.props.currentUser;H.emit("newMessage",{token:a.token,body:a.state.body,receiverId:e,sender:t.id}),H.emit("getMessagesWithUser",{token:a.token,receiverId:e}),a.setState({body:""})};var n=a.props.match.params.id;return a.props.getCurrentUser(),a.props.getUser(n),H.emit("getMessagesWithUser",{token:a.token,receiverId:n}),H.on("getMessagesWithUser",function(e){a.setState({messages:e.messages})}),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.user&&this.setState({user:e.user,currentUser:e.currentUser})}},{key:"render",value:function(){var e=this,t=this.state,a=t.messages,n=t.user,r=void 0===n?this.initUser:n;return s.a.createElement("div",{className:"col-md-10 col-xl-8 offset-2 mt-4 chat"},s.a.createElement("div",{className:"card"},s.a.createElement("div",{className:"card-header msg_head"},s.a.createElement("div",{className:"d-flex bd-highlight"},s.a.createElement("div",{className:"img_cont"},s.a.createElement("img",{src:r.profileImage,className:"img_cont rounded-circle",width:"50",height:"50"})),s.a.createElement("div",{className:"user_info"},s.a.createElement("h4",null,r.username),s.a.createElement("p",null,a.length," Messages")),s.a.createElement("div",{className:"video_cam"},s.a.createElement("span",null,s.a.createElement("i",{className:"fas fa-video"})),s.a.createElement("span",null,s.a.createElement("i",{className:"fas fa-phone"})))),s.a.createElement("span",{id:"action_menu_btn"},s.a.createElement("i",{className:"fas fa-ellipsis-v"})),s.a.createElement("div",{className:"action_menu"},s.a.createElement("ul",null,s.a.createElement("li",null,s.a.createElement("i",{className:"fas fa-user-circle"})," View profile"),s.a.createElement("li",null,s.a.createElement("i",{className:"fas fa-users"})," Add to close friends"),s.a.createElement("li",null,s.a.createElement("i",{className:"fas fa-plus"})," Add to group"),s.a.createElement("li",null,s.a.createElement("i",{className:"fas fa-ban"})," Block")))),s.a.createElement("div",{className:"card-body msg_card_body"},a.map(function(t){return e.message(t)})),s.a.createElement("div",{className:"card-footer"},s.a.createElement("div",{className:"input-group"},s.a.createElement("div",{className:"input-group-append"},s.a.createElement("span",{className:"input-group-text attach_btn"},s.a.createElement("i",{className:"fas fa-paperclip"}))),s.a.createElement("textarea",{className:"form-control type_msg",placeholder:"Type your message...",value:this.state.body,onChange:function(t){return e.setState({body:t.target.value})}}),s.a.createElement("div",{className:"input-group-append"},s.a.createElement("span",{className:"input-group-text send_btn"},s.a.createElement("button",{className:"glyphicon glyphicon-send",onClick:this.send},"Send")))))))}}]),t}(n.Component),F=Object(g.b)(function(e){return{currentUser:e.auth.user,messages:e.messages.messages,user:e.users.user}},{getCurrentUser:E,getUserMessages:Y,getUser:function(e){return function(t){fetch("".concat(h,"users/").concat(e)).then(function(e){return e.json()}).then(function(e){t({payload:e.user,type:"GET_USER"})})}}})(z),V=function(){return s.a.createElement("h2",null,"Home")},K=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement(p.a,null,s.a.createElement("div",null,s.a.createElement(G,null),s.a.createElement(d.b,{path:"/",exact:!0,component:V}),s.a.createElement(d.b,{path:"/message/:id",component:F}),s.a.createElement(d.b,{path:"/messages",component:J}),s.a.createElement(d.b,{path:"/login",component:U}),s.a.createElement(d.b,{path:"/signup",component:C})))}}]),t}(s.a.Component),$=a(37),q=a(91),Q=a(27),X={user:null,authStatus:!1,message:""},Z={messages:[]},ee={users:[],user:{}},te=Object($.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":case"GET_CURRENT_USER":return Object(Q.a)({},e,{user:t.payload});case"SIGNUP":return Object(Q.a)({},e,{message:t.payload});case"CHECK_LOGIN":return Object(Q.a)({},e,{authStatus:t.payload});case"AUTH_ERR":return Object(Q.a)({},e,{message:t.payload});default:return e}},messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_MESSAGES":return Object(Q.a)({},e,{messages:t.payload});default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_USERS":return Object(Q.a)({},e,{users:t.payload});case"GET_USER":return Object(Q.a)({},e,{user:t.payload});default:return e}}}),ae=Object($.d)(te,{},Object($.a)(q.a)),ne=function(){return s.a.createElement(g.a,{store:ae},s.a.createElement(K,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(ne,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},96:function(e,t,a){e.exports=a(146)}},[[96,1,2]]]);
//# sourceMappingURL=main.e6f9cc22.chunk.js.map